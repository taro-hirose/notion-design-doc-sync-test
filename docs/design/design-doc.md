---
generated_from: "product-spec.md"
generated_at: "2024-01-01T00:00:00.000Z"
notion_version: "2024-01-01T00:00:00.000Z"
---

# Design Doc: [機能名]

> このファイルはClaude APIによって自動生成されます。
> Product Spec Docの更新に応じて再生成されます。

## 1. システム要件

### 機能要件

| ID | 要件 | 優先度 | 備考 |
|----|------|-------|------|
| FR-001 | xxx | Must | - |
| FR-002 | xxx | Should | - |

### 非機能要件

| カテゴリ | 要件 | 目標値 |
|---------|------|-------|
| パフォーマンス | レスポンス時間 | < 200ms |
| 可用性 | 稼働率 | 99.9% |
| セキュリティ | 認証 | OAuth 2.0 |

## 2. アーキテクチャ

### システム構成図

```
┌─────────────┐     ┌─────────────┐     ┌─────────────┐
│   Client    │────▶│   API GW    │────▶│   Service   │
└─────────────┘     └─────────────┘     └─────────────┘
                                              │
                                              ▼
                                        ┌─────────────┐
                                        │     DB      │
                                        └─────────────┘
```

### コンポーネント

| コンポーネント | 責務 | 技術スタック |
|--------------|------|-------------|
| API Gateway | 認証、ルーティング | AWS API Gateway |
| Service | ビジネスロジック | Node.js |
| Database | データ永続化 | PostgreSQL |

## 3. データモデル

### ER図

```
┌──────────────┐       ┌──────────────┐
│    User      │       │    Order     │
├──────────────┤       ├──────────────┤
│ id (PK)      │──────<│ id (PK)      │
│ email        │       │ user_id (FK) │
│ name         │       │ status       │
│ created_at   │       │ created_at   │
└──────────────┘       └──────────────┘
```

### テーブル定義

#### users

| カラム | 型 | 制約 | 説明 |
|-------|-----|------|------|
| id | UUID | PK | - |
| email | VARCHAR(255) | UNIQUE, NOT NULL | - |
| name | VARCHAR(100) | NOT NULL | - |
| created_at | TIMESTAMP | NOT NULL | - |

## 4. API仕様

### エンドポイント一覧

| Method | Path | 説明 |
|--------|------|------|
| GET | /api/v1/users | ユーザー一覧取得 |
| POST | /api/v1/users | ユーザー作成 |
| GET | /api/v1/users/:id | ユーザー詳細取得 |

### リクエスト/レスポンス例

#### POST /api/v1/users

**Request**
```json
{
  "email": "user@example.com",
  "name": "John Doe"
}
```

**Response** (201 Created)
```json
{
  "id": "550e8400-e29b-41d4-a716-446655440000",
  "email": "user@example.com",
  "name": "John Doe",
  "created_at": "2024-01-15T10:30:00Z"
}
```

## 5. 処理フロー

### シーケンス図

```
Client          API GW          Service         DB
  │                │                │            │
  │  POST /users   │                │            │
  │───────────────▶│                │            │
  │                │  Authenticate  │            │
  │                │───────────────▶│            │
  │                │                │  INSERT    │
  │                │                │───────────▶│
  │                │                │    OK      │
  │                │                │◀───────────│
  │                │    Response    │            │
  │                │◀───────────────│            │
  │   201 Created  │                │            │
  │◀───────────────│                │            │
```

## 6. 技術的制約

### パフォーマンス

- API レスポンス: 95%ile < 200ms
- DB クエリ: < 50ms
- 同時接続数: 1000 connections

### セキュリティ

- 認証: JWT (RS256)
- 通信: TLS 1.3
- データ: AES-256 暗号化

### 依存関係

- Node.js >= 20.x
- PostgreSQL >= 15.x

## 7. テスト方針

### テストレベル

| レベル | 対象 | カバレッジ目標 |
|--------|------|--------------|
| Unit | ビジネスロジック | 80% |
| Integration | API エンドポイント | 100% |
| E2E | 主要フロー | 主要パス |

### テストケース（主要）

- [ ] ユーザー作成が成功すること
- [ ] 重複メールでエラーになること
- [ ] 認証なしでアクセス拒否されること

---

*このドキュメントは自動生成されました。最終更新: 2024-01-01T00:00:00.000Z*
